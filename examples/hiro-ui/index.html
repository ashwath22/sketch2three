<!DOCTYPE html><html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">

    <title>Sketch2three</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000000;
        }
        #three-box canvas {
            display: block;
            margin: auto;
            padding: 0;
            border : 0;
        }
    </style>
    
</head>
<body>
    <div id="three-box"></div>

    <script src='js/three.min.js'></script>
    <script src='js/OrbitControls.js'></script>
    <script src="js/VRControls.js"></script>
    <script src="js/VREffect.js"></script>
    <script src="js/webvr-polyfill.js"></script>
    <script src="js/webvr-manager.js"></script>
    <script src='../../dist/sketch2three.js'></script>
    
    <script>
    var renderer = new THREE.WebGLRenderer( { antialias: true } );
    document.body.appendChild(renderer.domElement);

    var effect = new THREE.VREffect(renderer);
    effect.setSize(window.innerWidth, window.innerHeight);

    var manager = new WebVRManager(effect);
    
    var scene = new THREE.Scene();

    var camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.0001, 10000 );
    camera.position.z = 0.0001;
    var controls = new THREE.OrbitControls(camera);
    
    var vrcontrols = new THREE.VRControls(camera);

    Sketch2three.load('images/index.json',{ 
        exclude: ['thunder.png'],
        pixelScale: 0.001
    }).then(function(meshes) {
        var group = new THREE.Object3D();
        group.position.z = -1;
        meshes.forEach(function(mesh) {
            group.add(mesh);
        });
        scene.add(group);
    });

    function animate() {
        
    
        if (manager.isVRMode()) {
            effect.render(scene, camera);
            vrcontrols.update();
        } else {
            renderer.render(scene, camera);
            controls.update();
        }

        requestAnimationFrame(animate);
     };

     function onWindowResize() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();

        effect.setSize( window.innerWidth, window.innerHeight );
    };
     
     animate();

    </script>
 </body>
</html>
